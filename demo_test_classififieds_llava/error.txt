[Config file]: /tmp/tmpl5doa0jt
[Unhandled Error] TypeError("argument 'ids': 'dict' object cannot be converted to 'Sequence'")
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 337, in test
    action = agent.next_action(
             ^^^^^^^^^^^^^^^^^^
  File "<@beartype(agent.agent.PromptAgent.next_action) at 0x7ff2d8633560>", line 135, in next_action
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/agent.py", line 158, in next_action
    prompt = self.prompt_constructor.construct(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/prompts/prompt_constructor.py", line 311, in construct
    obs = self.tokenizer.tokenizer.decode(encoded_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/transformers/models/llava/processing_llava.py", line 128, in decode
    return self.tokenizer.decode(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3811, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 625, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'dict' object cannot be converted to 'Sequence'
[Config file]: /tmp/tmpb9dhyvzs
[Unhandled Error] AttributeError("'LlavaProcessor' object has no attribute 'encode'")
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 337, in test
    action = agent.next_action(
             ^^^^^^^^^^^^^^^^^^
  File "<@beartype(agent.agent.PromptAgent.next_action) at 0x7f45eb82b4c0>", line 135, in next_action
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/agent.py", line 158, in next_action
    prompt = self.prompt_constructor.construct(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/prompts/prompt_constructor.py", line 309, in construct
    encoded_text = self.tokenizer(obs)#.process(obs, max_obs_length)
                   ^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/llms/tokenizers.py", line 39, in __call__
    return self.tokenizer.encode(text)
           ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'LlavaProcessor' object has no attribute 'encode'
[Config file]: /tmp/tmp9c5ir1ei
[Unhandled Error] AttributeError("'Tokenizer' object has no attribute 'lm_config'")
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 337, in test
    action = agent.next_action(
             ^^^^^^^^^^^^^^^^^^
  File "<@beartype(agent.agent.PromptAgent.next_action) at 0x7ff7a7a17380>", line 135, in next_action
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/agent.py", line 158, in next_action
    prompt = self.prompt_constructor.construct(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/prompts/prompt_constructor.py", line 309, in construct
    encoded_text = self.tokenizer(obs)#.process(obs, max_obs_length)
                   ^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/llms/tokenizers.py", line 39, in __call__
    if "llava" in self.lm_config.model:
                  ^^^^^^^^^^^^^^
AttributeError: 'Tokenizer' object has no attribute 'lm_config'
[Config file]: /tmp/tmpgdpls_qv
[Unhandled Error] AttributeError("'Tokenizer' object has no attribute 'llm_config'")
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 337, in test
    action = agent.next_action(
             ^^^^^^^^^^^^^^^^^^
  File "<@beartype(agent.agent.PromptAgent.next_action) at 0x7fc1ceb23380>", line 135, in next_action
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/agent.py", line 158, in next_action
    prompt = self.prompt_constructor.construct(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/prompts/prompt_constructor.py", line 309, in construct
    encoded_text = self.tokenizer(obs)#.process(obs, max_obs_length)
                   ^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/llms/tokenizers.py", line 39, in __call__
    if "llava" in self.llm_config.model:
                  ^^^^^^^^^^^^^^^
AttributeError: 'Tokenizer' object has no attribute 'llm_config'
[Config file]: /tmp/tmp1qathp5o
[Unhandled Error] TimeoutError('Timeout 30000ms exceeded while waiting for event "load"\n=========================== logs ===========================\nwaiting for event "load"\n============================================================')
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/browser_env/processors.py", line 1076, in process
    screenshot_bytes = page.screenshot()
                       ^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/sync_api/_generated.py", line 10042, in screenshot
    self._sync(
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_sync_base.py", line 109, in _sync
    return task.result()
           ^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_page.py", line 661, in screenshot
    encoded_binary = await self._channel.send("screenshot", params)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_connection.py", line 482, in wrap_api_call
    return await cb()
           ^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_connection.py", line 97, in inner_send
    result = next(iter(done)).result()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
playwright._impl._api_types.TimeoutError: Timeout 30000ms exceeded.
=========================== logs ===========================
taking page screenshot
============================================================

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 321, in test
    obs, info = env.reset(options={"config_file": config_file})
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(browser_env.envs.ScriptBrowserEnv.reset) at 0x7ff7a84be020>", line 51, in reset
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/browser_env/envs.py", line 264, in reset
    observation = self._get_obs()
                  ^^^^^^^^^^^^^^^
  File "<@beartype(browser_env.envs.ScriptBrowserEnv._get_obs) at 0x7ff7a84bdd00>", line 10, in _get_obs
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/browser_env/envs.py", line 225, in _get_obs
    obs = self.observation_handler.get_observation(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(browser_env.processors.ObservationHandler.get_observation) at 0x7ff7a95f3060>", line 52, in get_observation
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/browser_env/processors.py", line 1228, in get_observation
    image_obs, content_str = self.image_processor.process(page, client)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/browser_env/processors.py", line 1089, in process
    page.wait_for_event("load")
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/sync_api/_generated.py", line 9500, in wait_for_event
    self._sync(
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_sync_base.py", line 109, in _sync
    return task.result()
           ^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_page.py", line 508, in wait_for_event
    async with self.expect_event(event, predicate, timeout) as event_info:
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_event_context_manager.py", line 33, in __aexit__
    await self._future
playwright._impl._api_types.TimeoutError: Timeout 30000ms exceeded while waiting for event "load"
=========================== logs ===========================
waiting for event "load"
============================================================
[Config file]: /tmp/tmp4mz5dx06
[Unhandled Error] TypeError("'Tokenizer' object is not callable")
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 337, in test
    action = agent.next_action(
             ^^^^^^^^^^^^^^^^^^
  File "<@beartype(agent.agent.PromptAgent.next_action) at 0x7fdf2b27b4c0>", line 135, in next_action
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/agent.py", line 158, in next_action
    prompt = self.prompt_constructor.construct(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/prompts/prompt_constructor.py", line 309, in construct
    encoded_text = self.tokenizer(obs)#.process(obs, max_obs_length)
                   ^^^^^^^^^^^^^^^^^^^
TypeError: 'Tokenizer' object is not callable
[Config file]: /tmp/tmp4ea3xhi6
[Unhandled Error] Error('net::ERR_CONNECTION_REFUSED at http://127.0.0.1:9980/\n=========================== logs ===========================\nnavigating to "http://127.0.0.1:9980/", waiting until "load"\n============================================================')
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 321, in test
    obs, info = env.reset(options={"config_file": config_file})
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<@beartype(browser_env.envs.ScriptBrowserEnv.reset) at 0x7f08953ae2a0>", line 51, in reset
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/browser_env/envs.py", line 254, in reset
    self.setup(config_file=config_file)
  File "<@beartype(browser_env.envs.ScriptBrowserEnv.setup) at 0x7f08953adb20>", line 36, in setup
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/browser_env/envs.py", line 205, in setup
    page.goto(url)
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/sync_api/_generated.py", line 9303, in goto
    self._sync(
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_sync_base.py", line 109, in _sync
    return task.result()
           ^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_page.py", line 479, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_frame.py", line 147, in goto
    await self._channel.send("goto", locals_to_params(locals()))
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_connection.py", line 482, in wrap_api_call
    return await cb()
           ^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/playwright/_impl/_connection.py", line 97, in inner_send
    result = next(iter(done)).result()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
playwright._impl._api_types.Error: net::ERR_CONNECTION_REFUSED at http://127.0.0.1:9980/
=========================== logs ===========================
navigating to "http://127.0.0.1:9980/", waiting until "load"
============================================================
[Config file]: /tmp/tmp1t03eizp
[Unhandled Error] TypeError("'Tokenizer' object is not callable")
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 337, in test
    action = agent.next_action(
             ^^^^^^^^^^^^^^^^^^
  File "<@beartype(agent.agent.PromptAgent.next_action) at 0x7ffb3c383420>", line 135, in next_action
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/agent.py", line 158, in next_action
    prompt = self.prompt_constructor.construct(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/prompts/prompt_constructor.py", line 309, in construct
    encoded_text = self.tokenizer(obs)#.process(obs, max_obs_length)
                   ^^^^^^^^^^^^^^^^^^^
TypeError: 'Tokenizer' object is not callable
[Config file]: /tmp/tmptesz6w80
[Unhandled Error] TypeError("argument 'ids': 'NoneType' object cannot be converted to 'Sequence'")
Traceback (most recent call last):
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/run_demo.py", line 337, in test
    action = agent.next_action(
             ^^^^^^^^^^^^^^^^^^
  File "<@beartype(agent.agent.PromptAgent.next_action) at 0x7f22ff33b2e0>", line 135, in next_action
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/agent.py", line 158, in next_action
    prompt = self.prompt_constructor.construct(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/agent/prompts/prompt_constructor.py", line 311, in construct
    obs = self.tokenizer.decode(encoded_text)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local/scratch/lin.3976/web_eval/visualwebarena_edit/llms/tokenizers.py", line 36, in decode
    return self.tokenizer.decode(ids)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/transformers/models/llava/processing_llava.py", line 128, in decode
    return self.tokenizer.decode(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/transformers/tokenization_utils_base.py", line 3811, in decode
    return self._decode(
           ^^^^^^^^^^^^^
  File "/home/lin.3976/miniconda3/envs/colab/lib/python3.11/site-packages/transformers/tokenization_utils_fast.py", line 625, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument 'ids': 'NoneType' object cannot be converted to 'Sequence'
